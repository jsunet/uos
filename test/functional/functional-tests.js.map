{"version":3,"sources":["functional/functional-tests.js"],"names":["os","require","stream","crypto","async","_","fs","http","https","url","chai","assert","superagent","uuid","step","uos","err","install","describe","timeout","playConfig","process","env","res","split","endPoint","port","parseInt","accessKey","secretKey","undefined","useSSL","dataDir","partSize","client","Client","usEastConfig","region","clientUsEastRegion","bucketName","objectName","v4","_1byteObjectName","_1byte","readFileSync","Buffer","alloc","_100kbObjectName","_100kb","_100kbObjectNameCopy","_100kbObjectBufferName","_MultiPath100kbObjectBufferName","_100kbmd5","createHash","update","digest","_100kb1kboffsetmd5","slice","_65mbObjectName","_65mb","_65mbmd5","_65mbObjectNameCopy","_5mbObjectName","_5mb","_5mbmd5","httpAgent","Agent","keepAlive","setRequestOptions","agent","metaData","tmpDir","tmpdir","readableStream","data","s","Readable","_read","push","traceStream","filePath","stdout","createWriteStream","flags","write","traceOn","after","traceOff","end","done","bucketExists","e","exists","Error","then","catch","putObject","hash","getObject","on","removeObject","etag","modifiedDate","copyObject","statObject","stat","size","length","equal","conds","CopyConditions","setMatchETagExcept","setMatchETag","setUnmodified","Date","map","cb","listObjectPrefix","listObjectsNum","objArray","listArray","listPrefixArray","times","i","sort","mapLimit","listObjects","isEqual","name","listObjectsV2","extensions","listObjectsV2WithMetadata","objectsList","removeObjects"],"mappings":"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","sourcesContent":["const os = require('os')\nconst stream = require('stream')\nconst crypto = require('crypto')\nconst async = require('async')\nconst _ = require('lodash')\nconst fs = require('fs')\nconst http = require('http')\nconst https = require('https')\nconst url = require('url')\nconst chai = require('chai')\nconst assert = chai.assert\nconst superagent = require('superagent')\nconst uuid = require(\"uuid\")\nconst step = require(\"mocha-steps\").step\nimport { getVersionId, isArray } from \"../../../dist/main/helpers\"\nlet uos\n\ntry {\n  uos = require('../../../dist/main/uos')\n} catch (err) {\n  uos = require('uos')\n}\n\nrequire('source-map-support').install()\n\ndescribe('functional tests', function() {\n  this.timeout(30 * 60 * 1000)\n  var playConfig = {}\n  // If credentials aren't given, default to 47.96.39.108.\n  if (process.env['SERVER_ENDPOINT']) {\n    var res = process.env['SERVER_ENDPOINT'].split(\":\")\n    playConfig.endPoint = res[0]\n    playConfig.port = parseInt(res[1])\n  } else {\n    playConfig.endPoint = '10.10.0.12'\n    playConfig.port = 9901\n  }\n  playConfig.accessKey = process.env['ACCESS_KEY'] || 'admin'\n  playConfig.secretKey = process.env['SECRET_KEY'] || 'AKiaOS45E90A'\n\n  // If the user provides ENABLE_HTTPS, 1 = secure, anything else = unsecure.\n  // Otherwise default useSSL as true.\n  if (process.env['ENABLE_HTTPS'] !== undefined) {\n    playConfig.useSSL = (process.env['ENABLE_HTTPS'] == '1')\n  } else {\n    playConfig.useSSL = false\n  }\n  // dataDir is falsy if we need to generate data on the fly. Otherwise, it will be\n  // a directory with files to read from, i.e. /mint/data.\n  var dataDir = process.env['MINT_DATA_DIR']\n\n  // set the partSize to ensure multipart upload chunk size.\n  // if not set, putObject with stream data and undefined length will use about 500Mb chunkSize (5Tb/10000).\n  playConfig.partSize = 64 * 1024 * 1024\n\n  var client = new uos.Client(playConfig)\n  var usEastConfig = playConfig\n  usEastConfig.region = 'us-east-1'\n  var clientUsEastRegion = new uos.Client(usEastConfig)\n\n  var bucketName = '15860330905-bucket'\n  var objectName = uuid.v4()\n\n  var _1byteObjectName = 'datafile-1-b'\n  var _1byte = dataDir ? fs.readFileSync(dataDir + '/' + _1byteObjectName) : Buffer.alloc(1, 0)\n\n  var _100kbObjectName = 'datafile-100-kB'\n  var _100kb = dataDir ? fs.readFileSync(dataDir + '/' + _100kbObjectName) : Buffer.alloc(100 * 1024, 0)\n  var _100kbObjectNameCopy = _100kbObjectName + '-copy'\n\n  var _100kbObjectBufferName = `${_100kbObjectName}.buffer`\n  var _MultiPath100kbObjectBufferName = `path/to/${_100kbObjectName}.buffer`\n  var _100kbmd5 = crypto.createHash('md5').update(_100kb).digest('hex')\n  var _100kb1kboffsetmd5 = crypto.createHash('md5').update(_100kb.slice(1024)).digest('hex')\n\n  var _65mbObjectName = 'datafile-65-MB'\n  var _65mb = dataDir ? fs.readFileSync(dataDir + '/' + _65mbObjectName) : Buffer.alloc(65 * 1024 * 1024, 0)\n  var _65mbmd5 = crypto.createHash('md5').update(_65mb).digest('hex')\n  var _65mbObjectNameCopy = _65mbObjectName + '-copy'\n\n  var _5mbObjectName = 'datafile-5-MB'\n  var _5mb = dataDir ? fs.readFileSync(dataDir + '/' + _5mbObjectName) : Buffer.alloc(5 * 1024 * 1024, 0)\n  var _5mbmd5 = crypto.createHash('md5').update(_5mb).digest('hex')\n\n  // create new http agent to check requests release sockets\n  var httpAgent = (playConfig.useSSL ? https : http).Agent({ keepAlive: true })\n  client.setRequestOptions({ agent: httpAgent })\n\n  var metaData = {\n    'Content-Type': 'text/html',\n    'Content-Language': 'en',\n    'X-Amz-Meta-Testing': 1234,\n    'randomstuff': 5678\n  }\n\n  var tmpDir = os.tmpdir()\n    \n  function readableStream(data) {\n    var s = new stream.Readable()\n    s._read = () => {}\n    s.push(data)\n    s.push(null)\n    return s\n  }\n  \n  var traceStream\n\n  // FUNCTIONAL_TEST_TRACE env variable contains the path to which trace\n  // will be logged. Set it to /dev/stdout log to the stdout.\n  if (process.env['FUNCTIONAL_TEST_TRACE']) {\n    var filePath = process.env['FUNCTIONAL_TEST_TRACE']\n    // This is necessary for windows.\n    if (filePath === 'process.stdout') {\n      traceStream = process.stdout\n    } else {\n      traceStream = fs.createWriteStream(filePath, { flags: 'a' })\n    }\n    traceStream.write('====================================\\n')\n    client.traceOn(traceStream)\n  }\n\n  if (traceStream) {\n    after(() => {\n      client.traceOff()\n      if (filePath !== 'process.stdout') {\n        traceStream.end()\n      }\n    })\n  }\n\n  describe('bucketExists', () => {\n    step(`bucketExists(bucketName, cb)_bucketName:${bucketName}_`, done => client.bucketExists(bucketName, done))\n    step(`bucketExists(bucketName, cb)_bucketName:${bucketName}random_`, done => {\n      client.bucketExists(bucketName + 'random', (e, exists) => {\n        if (e === null && !exists) return done()\n        done(new Error())\n      })\n    })\n    step(`bucketExists(bucketName)_bucketName:${bucketName}_`, done => {\n      client.bucketExists(bucketName)\n        .then(() => done())\n        .catch(done)\n    })\n  })\n\n  describe('tests for putObject getObject removeObject with multipath', function() {\n    step(`putObject(bucketName, objectName, stream)_bucketName:${bucketName}, objectName:${_MultiPath100kbObjectBufferName}, stream:100Kib_`, done => {\n      client.putObject(bucketName, _MultiPath100kbObjectBufferName, _100kb)\n        .then(() => done())\n        .catch(done)\n    })\n\n    step(`getObject(bucketName, objectName, callback)_bucketName:${bucketName}, objectName:${_MultiPath100kbObjectBufferName}_`, done => {\n      var hash = crypto.createHash('md5')\n      client.getObject(bucketName, _MultiPath100kbObjectBufferName, (e, stream) => {\n        if (e) return done(e)\n        stream.on('data', data => hash.update(data))\n        stream.on('error', done)\n        stream.on('end', () => {\n          if (hash.digest('hex') === _100kbmd5) return done()\n          done(new Error('content mismatch'))\n        })\n      })\n    })\n\n    step(`removeObject(bucketName, objectName)_bucketName:${bucketName}, objectName:${_MultiPath100kbObjectBufferName}_`, done => {\n      client.removeObject(bucketName, _MultiPath100kbObjectBufferName)\n        .then(() => done())\n        .catch(done)\n    })\n\n  })\n\n  describe('tests for copyObject statObject', function() {\n    var etag\n    var modifiedDate\n    step(`putObject(bucketName, objectName, stream, metaData, cb)_bucketName:${bucketName}, objectName:${_100kbObjectName}, stream: 100kb, metaData:${metaData}_`, done => {\n      client.putObject(bucketName, _100kbObjectName, _100kb, metaData, done)\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}_`, done => {\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, (e) => {\n        if (e) return done(e)\n        done()\n      })\n    })\n\n    step(`statObject(bucketName, objectName, cb)_bucketName:${bucketName}, objectName:${_100kbObjectName}_`, done => {\n      client.statObject(bucketName, _100kbObjectName, (e, stat) => {\n        if (e) return done(e)\n        if (stat.size !== _100kb.length) return done(new Error('size mismatch'))\n        assert.equal(stat.metaData['content-type'], metaData['Content-Type'])\n        assert.equal(stat.metaData['Testing'], metaData['Testing'])\n        assert.equal(stat.metaData['randomstuff'], metaData['randomstuff'])\n        etag = stat.etag\n        modifiedDate = stat.modifiedDate\n        done()\n      })\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, conditions, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}, conditions:ExceptIncorrectEtag_`, done => {\n      var conds = new uos.CopyConditions()\n      conds.setMatchETagExcept('TestEtag')\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, conds, (e) => {\n        if (e) return done(e)\n        done()\n      })\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, conditions, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}, conditions:ExceptCorrectEtag_`, done => {\n      var conds = new uos.CopyConditions()\n      conds.setMatchETagExcept(etag)\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, conds)\n        .then(() => {\n          done(new Error(\"CopyObject should have failed.\"))\n        })\n        .catch(() => done())\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, conditions, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}, conditions:MatchCorrectEtag_`, done => {\n      var conds = new uos.CopyConditions()\n      conds.setMatchETag(etag)\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, conds, (e) => {\n        if (e) return done(e)\n        done()\n      })\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, conditions, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}, conditions:MatchIncorrectEtag_`, done => {\n      var conds = new uos.CopyConditions()\n      conds.setMatchETag('TestETag')\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, conds)\n        .then(() => {\n          done(new Error(\"CopyObject should have failed.\"))\n        })\n        .catch(() => done())\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, conditions, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}, conditions:Unmodified since ${modifiedDate}`, done => {\n      var conds = new uos.CopyConditions()\n      conds.setUnmodified(new Date(modifiedDate))\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, conds, (e) => {\n        if (e) return done(e)\n        done()\n      })\n    })\n\n    step(`copyObject(bucketName, objectName, srcObject, conditions, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}, srcObject:/${bucketName}/${_100kbObjectName}, conditions:Unmodified since 2010-03-26T12:00:00Z_`, done => {\n      var conds = new uos.CopyConditions()\n      conds.setUnmodified(new Date(\"2010-03-26T12:00:00Z\"))\n      client.copyObject(bucketName, _100kbObjectNameCopy, \"/\" + bucketName + \"/\" + _100kbObjectName, conds)\n        .then(() => {\n          done(new Error(\"CopyObject should have failed.\"))\n        })\n        .catch(() => done())\n    })\n\n    step(`statObject(bucketName, objectName, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}_`, done => {\n      client.statObject(bucketName, _100kbObjectNameCopy, (e, stat) => {\n        if (e) return done(e)\n        if (stat.size !== _100kb.length) return done(new Error('size mismatch'))\n        done()\n      })\n    })\n\n    step(`removeObject(bucketName, objectName, cb)_bucketName:${bucketName}, objectName:${_100kbObjectNameCopy}_`, done => {\n      async.map([_100kbObjectName, _100kbObjectNameCopy], (objectName, cb) => client.removeObject(bucketName, objectName, cb), done)\n    })\n\n  })\n\n  describe('listObjects', function() {\n    var listObjectPrefix = 'uosjsPrefix'\n    var listObjectsNum = 10\n    var objArray = []\n    var listArray = []\n    var listPrefixArray = []\n\n    step(`putObject(bucketName, objectName, stream, size, metaData, callback)_bucketName:${bucketName}, stream:1b, size:1_Create ${listObjectsNum} objects`, done => {\n      _.times(listObjectsNum, i => objArray.push(`${listObjectPrefix}.${i}`))\n      objArray = objArray.sort()\n      async.mapLimit(\n        objArray,\n        20,\n        (objectName, cb) => client.putObject(bucketName, objectName, readableStream(_1byte), _1byte.length, {}, cb),\n        done\n      )\n    })\n\n    step(`listObjects(bucketName, prefix, recursive)_bucketName:${bucketName}, prefix: uosjsprefix, recursive:true_`, done => {\n      client.listObjects(bucketName, listObjectPrefix, true)\n        .on('error', done)\n        .on('end', () => {\n          if (_.isEqual(objArray, listPrefixArray)) return done()\n          return done(new Error(`listObjects lists ${listPrefixArray.length} objects, expected ${listObjectsNum}`))\n        })\n        .on('data', data => {\n          listPrefixArray.push(data.name)\n        })\n    })\n\n    step('listObjects(bucketName, prefix, recursive)_recursive:true_', done => {\n      try {\n        client.listObjects(\"\", \"\", true)\n          .on('end', () => {\n            return done(new Error(`listObjects should throw exception when empty bucketname is passed`))\n          })\n      } catch (e) {\n        if (e.name === 'InvalidBucketNameError') {\n          done()\n        } else {\n          done(e)\n        }\n      }\n    })\n\n    step(`listObjects(bucketName, prefix, recursive)_bucketName:${bucketName}, recursive:false_`, done => {\n      listArray = []\n      client.listObjects(bucketName, '', false)\n        .on('error', done)\n        .on('end', () => {\n          if (_.isEqual(objArray, listArray)) return done()\n          return done(new Error(`listObjects lists ${listArray.length} objects, expected ${listObjectsNum}`))\n        })\n        .on('data', data => {\n          listArray.push(data.name)\n        })\n    })\n\n    step(`listObjectsV2(bucketName, prefix, recursive, startAfter)_bucketName:${bucketName}, recursive:true_`, done => {\n      listArray = []\n      client.listObjectsV2(bucketName, '', true,'')\n        .on('error', done)\n        .on('end', () => {\n          if (_.isEqual(objArray, listArray)) return done()\n          return done(new Error(`listObjects lists ${listArray.length} objects, expected ${listObjectsNum}`))\n        })\n        .on('data', data => {\n          listArray.push(data.name)\n        })\n    })\n\n    step(`listObjectsV2WithMetadata(bucketName, prefix, recursive, startAfter)_bucketName:${bucketName}, recursive:true_`, done => {\n      listArray = []\n      client.extensions.listObjectsV2WithMetadata(bucketName, '', true,'')\n        .on('error', done)\n        .on('end', () => {\n          if (_.isEqual(objArray, listArray)) return done()\n          return done(new Error(`listObjects lists ${listArray.length} objects, expected ${listObjectsNum}`))\n        })\n        .on('data', data => {\n          listArray.push(data.name)\n        })\n    })\n\n    step(`removeObject(bucketName, objectName, callback)_bucketName:${bucketName}_Remove ${listObjectsNum} objects`, done => {\n      async.mapLimit(\n        listArray,\n        20,\n        (objectName, cb) => client.removeObject(bucketName, objectName, cb),\n        done\n      )\n    })\n  })\n\n  describe('removeObjects', function() {\n    var listObjectPrefix = 'uosjsPrefix'\n    var listObjectsNum = 10\n    var objArray = []\n    var objectsList = []\n\n    step(`putObject(bucketName, objectName, stream, size, contentType, callback)_bucketName:${bucketName}, stream:1b, size:1_Create ${listObjectsNum} objects`, done => {\n      _.times(listObjectsNum, i => objArray.push(`${listObjectPrefix}.${i}`))\n      objArray = objArray.sort()\n      async.mapLimit(\n        objArray,\n        20,\n        (objectName, cb) => client.putObject(bucketName, objectName, readableStream(_1byte), _1byte.length, '', cb),\n        done\n      )\n    })\n\n    step(`listObjects(bucketName, prefix, recursive)_bucketName:${bucketName}, recursive:false_`, done => {\n      client.listObjects(bucketName, listObjectPrefix, false)\n        .on('error', done)\n        .on('end', () => {\n          try {\n            client.removeObjects(bucketName, '',function(e) {\n              if (e) {\n                done()\n              }\n            })\n          } catch (e) {\n            if (e.name === \"InvalidArgumentError\") {\n              done()\n            }\n          }\n        })\n        .on('data', data => {\n          objectsList.push(data.name)\n        })\n    })\n\n    objectsList = []\n\n    step(`listObjects(bucketName, prefix, recursive)_bucketName:${bucketName}, recursive:false_`, done => {\n      client.listObjects(bucketName, listObjectPrefix, false)\n        .on('error', done)\n        .on('end', () => {\n          client.removeObjects(bucketName, objectsList,function(e) {\n            if (e) {\n              done(e)\n            }\n            done()\n          })\n        })\n        .on('data', data => {\n          objectsList.push(data.name)\n        })\n    })\n\n    // Non latin characters\n    step(`putObject(bucketName, objectName, stream)_bucketName:${bucketName}, objectName:fileΩ, stream:1b`, done => {\n      client.putObject(bucketName, 'fileΩ', _1byte)\n        .then(() => done())\n        .catch(done)\n    })\n\n    step(`removeObjects with non latin charactes`, done => {\n      client.removeObjects(bucketName, ['fileΩ'])\n        .then(() => done())\n        .catch(done)\n    })\n\n  })\n\n})\n"],"file":"functional-tests.js"}